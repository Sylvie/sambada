/*************************************************************************
* Copyright (©) 2011-2022 EPFL (Ecole Polytechnique fédérale de Lausanne)
* Laboratory of Geographic information systems (LaSIG)
*
* This file is part of Sambada.
*
* Sambada is free software ; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation ; either version 3 of the License, or (at your option) any later version.
* Sambada is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY ; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
* You should have received a copy of the GNU General Public License along with Sambada ; if not, see <http://www.gnu.org/licenses/>.
*
* Authors : Sylvie Stucki (sylvie.stucki@a3.epfl.ch), Stéphane Joost (stephane.joost@epfl.ch)
* Laboratory of Geographic information systems
* EPFL ENAC IIE LASIG
* Station 18
* CH-1015 Lausanne
* Web site : http://lasig.epfl.ch/sambada
*************************************************************************/

#include "histograms/StoreyHistogramsStreamWriter.hpp"
#include "common/TypesCommuns.hpp"
#include "SambadaStoreyHistogramMapper.hpp"

#include "catch.hpp"

TEST_CASE("Test that StoreyHistogramsStreamWriter can write StoreyHistograms into output streams", "[storey-histograms-stream-writer-unit]")
{
	SECTION("Test that StoreyHistogramsStreamWriter sends correct data to output stream")
	{
		SambadaStoreyHistogram expectedStoreyHistogram;

		expectedStoreyHistogram.etiquettes = {"P-valeurs", "Scores", "G1", "GOrphelins1", "Wald1", "WaldOrphelins1", "G2", "GOrphelins2", "Wald2", "WaldOrphelins2", "G3", "GOrphelins3", "Wald3", "WaldOrphelins3", "GPop", "WaldPop"};

		expectedStoreyHistogram.header = {{0.95,                0.94,                0.93,              0.92,              0.91,              0.9,                0.89,               0.88,               0.87,               0.86,               0.85,               0.84,              0.83,               0.82,               0.81,               0.8,                0.79,               0.78,               0.77,               0.76,               0.75,              0.74,              0.73,              0.72,              0.71,              0.7,               0.69,              0.68,              0.67,             0.66,              0.65,              0.64,              0.63,             0.62,             0.61,              0.6,               0.59,              0.58,              0.57,              0.56,              0.55,             0.54,              0.53,              0.52,              0.51,              0.5,               0.49,              0.48,              0.47,              0.46,              0.45,              0.44, 0.43, 0.42, 0.41, 0.4, 0.39, 0.38, 0.37, 0.36, 0.35, 0.34, 0.33, 0.32, 0.31, 0.3, 0.29, 0.28, 0.27, 0.26, 0.25, 0.24, 0.23, 0.22, 0.21, 0.2, 0.19, 0.18, 0.17, 0.16, 0.15, 0.14, 0.13, 0.12, 0.11, 0.1, 0.09, 0.08, 0.07, 0.0599999999999999, 0.0499999999999999, 0.0399999999999999, 0.0299999999999999, 0.0199999999999999, 0.0099999999999999, 0},
		                                  {0.00393214000001953, 0.00566555214052741, 0.007716715544952, 0.010086932215776, 0.012777711671053, 0.0157907740934313, 0.0191280539398315, 0.0227917040277124, 0.0267841001161233, 0.0311078460021464, 0.0357657791558977, 0.040760976920001, 0.0460967633024078, 0.0517767163946213, 0.0578046764508421, 0.0641847546673016, 0.0709213427051411, 0.0780191230046582, 0.0854830799436345, 0.0933185118978289, 0.101531044267622, 0.110126643541314, 0.119111632472776, 0.128492706459102, 0.138276951212761, 0.148471861832546, 0.159085363388553, 0.170125833148597, 0.18160212458709, 0.193523593332646, 0.205900125227766, 0.218742166693153, 0.23206075761083, 0.24586756696459, 0.260174931503893, 0.274995897728456, 0.290344267526239, 0.306234647837711, 0.322682504765163, 0.339704222598183, 0.35731716828632, 0.375539761958745, 0.394391554169761, 0.413893310640177, 0.434067105369943, 0.454936423119573, 0.476526272399809, 0.498863310274476, 0.521975980474872, 0.545894666550918, 0.570651862051189, 0.596282360039052, 0.622823464625417, 0.650315227642454, 0.678800714112448, 0.708326300800794, 0.738942012906212, 0.770701904864674, 0.803664492364912, 0.837893244041483, 0.87345714298923, 0.910431330311541, 0.94889784547952, 0.988946481478024, 1.03067577672932, 1.07419417085759, 1.11962135781185, 1.16708987813886, 1.21674700288959, 1.2687569755773, 1.32330369693147, 1.38059396152976, 1.44086138805315, 1.50437122924054, 1.57142630852761, 1.64237441514982, 1.7176176092514, 1.79762406036565, 1.88294329343061, 1.97422608959095, 2.07225085582224, 2.17795915885414, 2.29250452609228, 2.41732093045561, 2.55422131249636, 2.70554345409542, 2.874373395996, 3.06490172007636, 3.28302028675954, 3.5373845964626, 3.84145882069412, 4.2178845879214, 4.70929224688511, 5.41189443105435, 6.63489660102123}};

		expectedStoreyHistogram.valeurs = {{0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 3, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 2, 0, 1, 1, 1, 0, 0, 0, 2, 1, 1, 0, 1, 3, 0, 0, 0, 1, 0, 0, 5, 4, 2, 1, 3, 1, 0, 2, 4, 2, 4, 9, 140},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 3, 0, 0, 1, 0, 0, 1, 0, 0, 2, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 2, 0, 1, 0, 0, 1, 0, 0, 2, 4, 0, 0, 0, 2, 1, 0, 0, 1, 0, 1, 6, 3, 2, 1, 2, 2, 1, 1, 3, 3, 5, 7, 140},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 7},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1, 1, 0, 0, 0, 1, 3, 0, 0, 0, 1, 0, 1, 0, 0, 7},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {9, 1, 0, 0, 2, 1, 2, 0, 0, 4, 3, 0, 1, 1, 3, 0, 1, 1, 0, 1, 4, 5, 3, 1, 5, 0, 0, 1, 1, 3, 4, 1, 2, 1, 1, 2, 4, 0, 1, 2, 2, 2, 3, 1, 0, 1, 1, 2, 1, 3, 1, 0, 1, 2, 1, 1, 1, 0, 1, 0, 2, 0, 0, 0, 1, 1, 1, 1, 2, 0, 0, 1, 1, 0, 1, 2, 2, 1, 3, 0, 3, 1, 0, 2, 4, 2, 0, 3, 2, 1, 2, 3, 0, 3, 1, 9},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {9, 1, 0, 0, 2, 1, 2, 0, 0, 4, 3, 0, 1, 3, 1, 0, 0, 4, 1, 1, 2, 4, 3, 1, 4, 1, 0, 0, 2, 4, 3, 1, 3, 0, 2, 3, 2, 1, 1, 3, 1, 3, 1, 2, 0, 0, 3, 1, 0, 3, 1, 0, 2, 0, 2, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 2, 0, 2, 0, 0, 1, 2, 1, 0, 1, 1, 1, 2, 3, 1, 2, 1, 1, 3, 2, 1, 2, 2, 3, 2, 2, 1, 3, 2, 7},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {9, 1, 0, 0, 2, 1, 1, 0, 0, 3, 0, 0, 1, 1, 2, 0, 0, 0, 0, 1, 2, 3, 3, 1, 3, 0, 0, 1, 1, 3, 4, 1, 0, 0, 1, 2, 3, 0, 1, 1, 1, 3, 1, 0, 0, 0, 0, 1, 2, 4, 1, 0, 1, 1, 1, 0, 1, 0, 0, 2, 0, 0, 1, 0, 1, 3, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 2, 3, 1, 1, 4, 2, 0, 3, 2, 0, 2, 2, 1, 6, 5, 33},
		                                   {9, 1, 0, 0, 2, 1, 1, 0, 0, 3, 0, 0, 1, 2, 1, 0, 0, 0, 0, 1, 2, 3, 3, 1, 3, 0, 0, 1, 1, 3, 4, 0, 1, 0, 1, 3, 1, 1, 1, 1, 1, 3, 1, 0, 0, 0, 0, 1, 1, 4, 1, 1, 2, 0, 1, 1, 0, 0, 0, 2, 0, 1, 0, 0, 1, 3, 1, 0, 1, 0, 0, 1, 0, 0, 0, 2, 0, 0, 2, 1, 2, 2, 2, 0, 5, 1, 1, 2, 2, 0, 2, 2, 2, 5, 5, 33}
		};


		std::vector<std::vector<sambada::reel> > GScores({
				                                                 {
						                                                 393.949951509768, 353.885363268917, 278.512496775078, 216.156931302346, 180.940391598576, 202.926694969315, 200.818381582413, 200.732817799452, 186.04478249851,  172.664962510671, 178.454149129625, 163.175093924547, 170.433242855714, 145.857925626891, 166.38209011695,  141.734405787342, 134.181356903727, 141.818753384617,  160.936242443686,  133.602628822658,  176.80528013519,  142.99264803151,   132.885100929244,  130.42295599695,   123.890473651454,  140.090340603917,  126.220521780338,  142.420296902169,  140.319054048203,   119.573005636945, 133.552891994526, 115.464151239751, 129.781587262074, 103.170074076126, 105.732655011715, 100.203139152104, 98.6993350237508, 98.9921388835725, 93.9826186690765, 91.018999657901,  94.1736191584592, 88.1397023897944, 99.7601123097304, 98.3207439558082, 142.269945680323, 81.4543331409993, 166.382388403016, 83.0733569680547, 90.5655904298121, 88.2889186171084, 72.3354143631421, 72.0365863386888, 70.1657773006597, 70.8438835309048,  70.5786711262128,  71.0131979250316, 71.9411541374465, 74.0260776888945, 67.1244915363496, 73.9553228921615, 71.4331291681609, 70.9531676012675, 64.6070801374461, 64.0371982732709, 66.5305755013484, 60.358568972232, 63.5624925119325, 58.6894592199744, 64.6973231903883, 55.380656151135, 53.6666556264024, 53.5951420515159, 58.645690152474, 52.6879936600277, 57.7957403102149, 52.6056020135212, 49.724560876745, 76.4105455312242, 50.1858060969084, 54.1603648072546, 48.2001533789776, 52.7868784435638, 47.021505400787, 42.0433605690271, 45.7957752714054, 40.1020995131078, 40.1614263538354, 39.3265601183218, 38.0778209217394, 38.6181794598155, 41.9521916771594, 41.8705059570142, 35.109251795452, 34.7242322446394, 39.7718604081135, 33.8124022549054, 33.3033899494915, 31.1477521041288, 33.4833423721856, 33.7062058510041, 32.001301235603, 28.7498460574013, 28.5207320846052, 29.264137196086, 27.2481375857658, 31.9384190129585, 25.0039693217186, 21.6095877152546, 21.2644063862291, 20.1833367724928, 20.5250712707164, 19.2262296181383, 16.4620700097188, 14.1983666361308, 16.6585215961344, 26.0390484782074, 15.0275854565216, 15.4733367900841, 13.6994365361926, 14.2477425207965, 13.39262900342, 14.2378706786969, 11.6145993788587, 11.6186015583056, 10.6502995592848, 10.250898108008, 11.4496940598331, 10.0715163810867, 10.3216163520063, 9.63427085389253, 17.7249678755857, 8.52747158095781, 8.82768794086178, 13.7175878664813, 8.45193422825594, 8.09247930492006, 7.55135091243221, 7.39296654656459, 7.44097271442081, 7.30726712694445, 6.50194525367294, 6.19110193668939, 6.21408646419422, 6.0596774557257, 6.03865328858512, 5.66982489319378, 5.54029477049573, 5.47833565388555, 5.34523901527575, 5.54084142357851, 5.04626595028753, 4.92130091015599, 4.71258734090225, 4.5730189964487, 4.43573928014962, 4.06601135556309, 3.97070440943912, 4.06412308534243, 3.74701246077336, 3.8431083105977, 3.28191854489023, 3.5530381342478, 3.03102555354337, 2.84007241682491, 2.95609268234853, 2.59599135577093, 2.53038359275706, 2.44648560419466, 2.38664606709813, 2.54990937015748, 2.40781177693248, 2.98681151795297, 2.46021918026196, 2.63080024130512, 2.05858226160402, 2.39340521446502, 2.34173870141636, 2.36374238021131, 1.65640047880311, 1.70370962346374, 1.67029446774313, 1.48449543343632, 1.39570410488545, 1.58994664187423, 1.36911200849568, 1.12225146846555, 1.33478320692097, 1.08962458406577, 1.0374536747986, 0.983984885730337, 0.958449466164666, 0.777753254379945, 0.754140341264815, 0.582159304743641, 0.51618336687693, 0.790489303602442, 0.374352460496198, 0.372480340108126, 0.346401927429724, 0.324577854921245, 0.186140381371843, 0.178788872862071, 0.131320856314687, 0.110373426144179, 0.0815353324976513, 0.0618435788875615, 0.0623536512323426, 0.0615414345309091, 0.0265022108701487, 0.00802248055674681
				                                                 },
				                                                 {       17.0791246207324, 16.6755734446276, 11.6541518883481, 14.1890330139211, 8.70436601226538, 14.0420487944288, 11.53186443759,   4.55439372818319, 3.35293027424893, 2.94117472630273, 2.19873637264715, 2.74071837275233, 2.58657569639149, 1.78484308451755, 1.96615226941026, 2.10573824844278, 2.0552902141842,  0.833700578860316, 0.791147325777615, 0.724230435902598, 0.64507324916201, 0.661274142648949, 0.415426074987863, 0.602524738974751, 0.357991684671561, 0.303886906560365, 0.188322987318088, 0.129024545103491, 0.0627333004347292, 0.0169091448838117},
				                                                 {
						                                                 16.7327582465851, 14.9519478160137, 12.1465620946101, 10.9427118491534, 8.60027214716251, 9.38301663649486, 7.06175514048107, 6.43477864237263, 8.48678318251643, 7.17929018632981, 4.87435743023752, 4.75625060959953, 4.71230031949045, 4.09126814631657, 3.84539109286561, 3.68722867612655, 3.79616304301476, 2.88153131023819,  3.41825997476485,  4.04128667941029,  3.25709422381794, 3.07948332142468,  2.52185681788296,  2.95877114090308,  2.99620791332148,  2.65275394755201,  2.60576753397663,  2.45099789871711,  2.4741513681081,    2.43933198312777, 2.30661395346453, 2.32396232395081, 2.15181934890859, 2.06645824955933, 1.98729270452816, 1.98109361731258, 1.82866024497935, 1.87620223861688, 1.57657222705598, 1.83378256075798, 1.74532464526908, 1.71370052473128, 1.64514291648743, 1.61810660841854, 1.5395209981358,  1.42118955240051, 1.34752636715621, 1.20165933576379, 1.17023890651728, 1.12942905139221, 1.0874578674327,  1.06271095654381, 1.01941693113884, 0.850210812593843, 0.798819560914808, 0.857751323756588, 0.715081713913037, 0.684479121479285, 0.673092714901941, 0.646472538801277, 0.63412820885236, 0.601419974791952, 0.552499803755609, 0.535945993511518, 0.539113178317962, 0.531951155061961, 0.486872144555491, 0.51469960827194, 0.449396361387358, 0.474159180925085, 0.408451155558964, 0.38512160103005, 0.389489859715923, 0.348018247331424, 0.358667887341085, 0.358935983145898, 0.481300722445127, 0.339656013793501, 0.331909948770772, 0.346495675863821, 0.313500575440685, 0.288043096836475, 0.391716726100157, 0.29021353067651, 0.275540812126565, 0.272711125497722, 0.264448476216444, 0.252477811146036, 0.240403722873225, 0.222796933263908, 0.218630005631837, 0.220781980407082, 0.275260773385895, 0.203330634805752, 0.201418113006469, 0.195529992959223, 0.199035222293986, 0.191697489181593, 0.18852730486401, 0.182070671967949, 0.173898053882112, 0.169365836007501, 0.137985819760502, 0.136815048297876, 0.135855656484637, 0.129455107790022, 0.128899332972367, 0.123752907627022, 0.117088749391655, 0.111258455390839, 0.111476717141045, 0.105591690772712, 0.10572171082697, 0.103662708297634, 0.101777918380321, 0.0948415542342218, 0.0936061587992754, 0.0891243953428784, 0.103466246428937, 0.0999811316084305, 0.09519349212718, 0.0720165131880321, 0.0704525497592385, 0.0554287911890015, 0.0532857348097195, 0.0525618139704562, 0.0492864459106954, 0.0428688739580139, 0.0350462795122439, 0.0327983201436837, 0.0314396353933262, 0.0307155863370099, 0.030367642005217, 0.0293285980617384, 0.0274944245499, 0.0184225385135051, 0.0166480415564365, 0.0136538181333208, 0.0122873798907221, 0.0106850652329058, 0.00430316354027127, 0.00359681688553337, 0.00300829998519703, 0.00245608875286507, 0.00208598889241784, 0.00170675502408812, 0.00133940809303112, 0.00118578230876665, 0.000869578624019596, 0.000654287202678461
				                                                 }
		                                                 });

		std::vector<std::vector<sambada::reel> > WaldScores({
				                                                    {
						                                                    258.264600261147, 246.405288836367, 212.061267713183, 172.562696631213, 150.184842034151, 148.428318228663, 147.604225832285, 143.731698774969, 141.988196814782, 139.170569077467, 138.112317173824, 130.951359335134, 126.856291790207, 122.588537123702, 119.821524692964, 117.105570897479, 115.434334398785, 114.703190922502,  111.211799305358,  110.740576620846, 110.229320372175,  110.203752260097,  110.083797860646,  105.370670224761,  104.56272395389,   103.822080585162,  103.807961596017,  103.051006869041,   101.911328027795,   99.6223694537238, 98.2332416220329, 97.7333629713996, 96.0636179141156, 88.0179060181028, 85.7771332668375, 85.2461728249231, 84.5752040559164, 83.3182222978706, 81.311131560197, 79.4777608509313, 77.9842911820666, 77.7271254090635, 77.6622299411224, 77.6420921639193, 75.4546036086265, 73.1956022464983, 73.1401167273493, 72.2783323717332, 70.1063947051334, 68.7994177775958, 65.5345490973509, 64.395993129384,  63.190637170301,  63.085695681139,   62.9774747380425,  62.6754065829946, 62.0763457116979, 60.9710292890915, 60.8415097572546, 60.3157517156913, 59.3314817906474, 58.974811520801, 58.3014738923693, 57.935450494516, 56.9092810368456, 56.0559475988607, 54.4880312625743, 53.4488452722908, 52.2709861203422, 50.1981804625788, 50.0012653539051, 49.4371813461718, 49.1643759749983, 49.0477811419813, 48.5722648001888, 48.4658241955269, 47.8367942899173, 46.8919337920812, 46.7361898924846, 45.0937050578169, 44.7903697263652, 44.4385186016128, 40.5035318476328, 39.3634941434121, 38.7080988325024, 38.1566501875069, 37.8075322890678, 36.7678123623005, 36.1825658599063, 36.1171999142192, 35.7445154865424, 35.6479909009792, 35.188402329961, 34.8422174992907, 34.513426420426, 32.2794018204241, 31.9218435323404, 29.8723446818403, 29.8223982774737, 29.6758442461429, 28.5851813227425, 27.6629618832722, 27.237024935442, 27.0449171788149, 26.1060471161396, 24.5786944721275, 24.1499230180474, 21.3262282627104, 20.6265548002826, 19.9183212974271, 19.7455986806562, 17.6533270922097, 16.0327577636289, 15.7798079868791, 15.4733289606568, 14.3373522270674, 14.2555679063826, 14.1848992989625, 13.4333868962959, 12.9039368355601, 12.7412683052736, 12.6018200057542, 11.4562480118976, 11.415663922337, 10.5034569254555, 10.2178929041793, 10.0474588473911, 10.0155561880237, 9.34592947090753, 9.26981025022267, 8.89400179651615, 8.44321244656877, 8.44299906284602, 8.33388907530749, 8.3310734961936, 7.99570146187275, 7.38640418813105, 7.33811534352839, 7.25945609357655, 7.23666913549503, 6.28782836379681, 6.19343355517015, 6.16050583440334, 6.02535752019399, 5.97386670125258, 5.54314590784898, 5.48861991809781, 5.3683468198136, 5.28227477845912, 5.10485996819791, 5.01739011959191, 4.87758622580074, 4.59386869216882, 4.4491569906142, 4.40828541237771, 4.11368134680868, 4.0337235122348, 3.86005064284758, 3.71444890674543, 3.37437620199707, 3.26859242757474, 3.0769888463192, 2.93925284056403, 2.89119365888461, 2.82556703504221, 2.58073951704144, 2.55504591891739, 2.50020445797354, 2.49230008678924, 2.48490672287023, 2.40313464629183, 2.38839577167827, 2.38633078419243, 2.38294707825187, 2.37528896824304, 2.30701925246025, 2.21857780121161, 2.02154832682789, 1.75340014627323, 1.69673661408632, 1.6663066280952, 1.41882981856329, 1.41730289013083, 1.40052705196261, 1.39559550096401, 1.34579681438192, 1.32997901957808, 1.17798121148932, 1.03484208512975, 0.981315389124832, 0.961212910343522, 0.838391940087559, 0.79322321147917, 0.620091559920397, 0.522131909498495, 0.470649475665961, 0.387500902234686, 0.370254682977214, 0.348379799526421, 0.34590164273308, 0.188066241653452, 0.132361713782867, 0.130961551162071, 0.110105371206388, 0.0807827526952061, 0.0629268870336548, 0.0623783592893298, 0.0593151203000924, 0.0265013285821112, 0.00806386929933381
				                                                    },
				                                                    {       16.2299323009388, 14.084993307253,  11.486399127526,  10.0390685989543, 8.46712864190336, 8.18056799088184, 7.32686691783119, 4.60793423249846, 3.63139216454041, 2.8185936414377,  2.78211271909262, 2.76914253916819, 2.70398674451952, 2.0780791594553,  2.00486260728186, 1.85671080795847, 1.84925976357078, 0.901879960823952, 0.832807005567993, 0.81390339156979, 0.690025256249808, 0.601307990038113, 0.430656248473507, 0.408498669311501, 0.360039848905913, 0.313635253114071, 0.190291685280185, 0.0966902762057164, 0.0627585210187139, 0.0169818135716442},
				                                                    {
						                                                    16.7057144613222, 14.7505192052027, 11.9016103948436, 10.618396148621,  8.05350649551352, 7.33401667486825, 6.66137658835453, 6.32620350234818, 6.31594416453469, 5.04518796305885, 4.90793311647243, 4.82913144240392, 4.64396538024632, 4.14311480208551, 3.9038143614346,  3.73898180031013, 3.63014263056341, 3.50677812073047,  3.45275009042105,  3.44979110372373, 3.15092106383462,  3.08761485066824,  3.01944628594831,  2.88916363903907,  2.8592614574653,   2.66974667592562,  2.60453978552901,  2.51438885863864,   2.49849999743817,   2.49801262739527, 2.40766875634933, 2.29028438151224, 2.15898638975217, 2.14560431334926, 2.07044215030533, 1.95418473418235, 1.88888594754324, 1.88650616172238, 1.8198721207564, 1.81193155521888, 1.75909911115049, 1.69745221456066, 1.62846548699934, 1.44782527185428, 1.4064548383697,  1.402257579811,   1.35519843738159, 1.19200677769228, 1.1758166909225,  1.1093815936921,  1.08911002693294, 1.05248084609684, 1.01504412584237, 0.964101350067133, 0.836203780534342, 0.769820542419538, 0.711014107759879, 0.704565783258251, 0.677095303890912, 0.676804631539347, 0.622458157794941, 0.605564274894241, 0.551713329151314, 0.540278693926871, 0.535068804226974, 0.534083658593357, 0.486997493094134, 0.47342904145533, 0.466691322509271, 0.466314513482617, 0.406713874644601, 0.398807667014405, 0.392418978084885, 0.35982835590929, 0.3593186813743, 0.358356148140949, 0.340050205426053, 0.33588919183582, 0.335315055145836, 0.333069641567544, 0.312911673525574, 0.293959092019542, 0.287502292456675, 0.287114929535302, 0.274679459410518, 0.270069486428297, 0.263317153901112, 0.252336888625688, 0.247082018985189, 0.223696327749984, 0.22289007378723, 0.220453700332539, 0.216455951289174, 0.204189576112103, 0.203816856242006, 0.195866800084742, 0.193318046531763, 0.19150467861053, 0.188253966476271, 0.183148949206966, 0.174148552065552, 0.171052673157679, 0.138830698342532, 0.135806003856863, 0.129894012486075, 0.129137032920589, 0.128929674102549, 0.124212659761899, 0.116332776348904, 0.110977443853375, 0.110657427410986, 0.106322915201546, 0.105996897565717, 0.10451350853217, 0.101738128945839, 0.0950860879735766, 0.0936167676896599, 0.0895459928979593, 0.0792479340809267, 0.0774187338193672, 0.0738514135266331, 0.072636059897768, 0.0723717762159917, 0.055363013399337, 0.0517497657333976, 0.0517128935875855, 0.0500167044763647, 0.0428512775058219, 0.0352569789652512, 0.0326147198007676, 0.0315605005571588, 0.0308882793101364, 0.0304228868682757, 0.0293200601494461, 0.0275195763334376, 0.0184817721306083, 0.0166723589854385, 0.0136916887517227, 0.0122945727900386, 0.0106811602779099, 0.00430952511405818, 0.00359866510988527, 0.00301215254047329, 0.00246264924247654, 0.0020866097207702, 0.00170724674071023, 0.00133918028616061, 0.00118537483156833, 0.000869421311893521, 0.000654332378541978
				                                                    }
		                                                    });

		std::vector<std::vector<sambada::reel> > popScores({
				                                                   {
						                                                   47.5508020099315, 17.8746547565823, 41.3946973283983, 13.2273316275405, 8.60027214716251, 9.38301663649486, 7.06175514048107, 6.43477864237263, 60.9753162647014, 9.46054160086123, 4.87435743023752, 4.75625060959953, 4.71230031949045, 5.07212153414218, 5.76215579054019, 3.68722867612655, 6.40749147073564, 17.6056374560984, 9.07592131335366, 5.07963522409273, 3.25709422381794, 3.07948332142468, 5.99775666160588, 2.95877114090308, 2.99620791332148, 2.65275394755201, 8.49670853015789, 12.6532301474047, 2.4741513681081,  2.43933198312777, 3.9477895884072,  2.32396232395081, 2.15181934890859, 3.92003576871639, 20.2534422625565, 1.98109361731258, 13.6480430928434, 13.5628581284628, 4.27541903406859, 1.83378256075798, 13.9187170792929, 49.0912298822102, 1.64514291648743, 2.95266037804299, 12.9170895335112, 38.20134419201,   1.34752636715621, 1.20165933576379, 7.3390942002236,  1.12942905139221, 9.62218644794984, 1.06271095654381, 1.01941693113884, 1.9037098376989,  2.10568451757081, 5.74248068468989, 1.98497615834549, 0.711602905646942, 0.673092714901941, 0.809344489206751, 0.63412820885236, 0.620483123303302, 0.552499803755609, 0.535945993511518, 0.539113178317962, 0.531951155061961, 0.486872144555491, 1.03661705899788, 4.860531961481, 11.7091360121462, 1.63428799949418, 0.910882391787368, 0.389489859715923, 0.545043464147966, 0.358667887341085, 0.358935983145898, 0.819294943689897, 0.339656013793501, 2.56260400306905, 7.7126808083907, 0.313500575440685, 0.288043096836475, 3.71285446879551, 0.29021353067651, 0.275540812126565, 0.272711125497722, 0.264448476216444, 0.252477811146036, 0.343637586605041, 2.47979971862264, 0.218630005631837, 1.05357082418845, 2.09230010354733, 2.52882922603681, 0.201418113006469, 0.195529992959223, 0.199035222293986, 0.191697489181593, 0.18852730486401, 20.1521431603426, 0.173898053882112, 0.195955008342025, 15.0508415854339, 0.136815048297876, 19.0563384681665, 0.129455107790022, 0.128899332972367, 0.123752907627022, 0.117088749391655, 0.111258455390839, 0.111476717141045, 0.105591690772712, 0.10572171082697, 2.20414882775776, 0.101777918380321, 0.0948415542342218, 0.0936061587992754, 0.0891243953428784, 0.520716267685785, 0.190741899003029, 0.366561509310657, 6.65955823929983, 16.8098670408702, 0.0554287911890015, 55.3446999942083, 0.0525618139704562, 0.0492864459106954, 0.0428688739580139, 0.517722496794931, 7.93659103398238, 11.2176856416345, 0.164087439094715, 0.030367642005217, 0.0293285980617384, 0.0274944245499, 11.3346413757181, 0.0166480415564365, 0.0136538181333208, 0.0122873798907221, 0.0106850652329058, 0.00430316354027127, 0.00359681688553337, 0.00300829998519703, 0.00245608875286507, 0.00208598889241784, 0.00170675502408812, 0.00133940809303112, 0.00118578230876665, 0.000869578624019596, 0.000654287202678461
				                                                   },
				                                                   {
						                                                   39.8279822628157, 17.5355078954831, 35.7750763561748, 13.1079784454148, 8.05350649551352, 9.02870635119507, 6.80159976120709, 6.32620350234818, 54.2708675504136, 9.05781176426883, 4.90793311647243, 4.82913144240392, 4.64396538024632, 5.00450667262304, 5.63509017629403, 3.73898180031013, 6.09315438937869, 17.8373307233592, 8.92631263729097, 5.00798584426854, 3.15092106383462, 3.08761485066824, 5.87269916338002, 2.88916363903907, 2.8592614574653,  2.66974667592562, 8.3641016468639,  12.2904428712594, 2.49849999743817, 2.49801262739527, 3.94245013347282, 2.29028438151224, 2.15898638975217, 3.76848251137127, 18.6396940589113, 1.95418473418235, 13.2711768218222, 12.7612109924091, 4.39622917270267, 1.81193155521888, 13.4948250897266, 44.5742167958631, 1.62846548699934, 2.95765038087526, 12.8723423997447, 35.0903369076723, 1.35519843738159, 1.19200677769228, 7.08779237826081, 1.1093815936921,  9.40622899216253, 1.05248084609684, 1.01504412584237, 1.83714665347872, 2.07594900763496, 5.83442557928908, 1.98613554480328, 0.704565783258251, 0.677095303890912, 0.805962100042454, 0.622458157794941, 0.618668806128414, 0.551713329151314, 0.540278693926871, 0.535068804226974, 0.534083658593357, 0.486997493094134, 1.04123302888657, 4.74244978414205, 11.232357660281, 1.63601110635403, 0.909953797510421, 0.392418978084885, 0.54097412059982, 0.3593186813743, 0.358356148140949, 0.836088455053715, 0.33588919183582, 2.53218086562595, 7.352987752017, 0.312911673525574, 0.293959092019542, 4.12103240008625, 0.287114929535302, 0.274679459410518, 0.270069486428297, 0.263317153901112, 0.252336888625688, 0.339848863234197, 2.43484655243785, 0.22289007378723, 1.05434364763425, 2.05380650005053, 2.51914909418609, 0.203816856242006, 0.195866800084742, 0.193318046531763, 0.19150467861053, 0.188253966476271, 18.7315330194447, 0.174148552065552, 0.196355865611352, 14.6118469286213, 0.135806003856863, 18.5497220515591, 0.129137032920589, 0.128929674102549, 0.124212659761899, 0.116332776348904, 0.110977443853375, 0.110657427410986, 0.106322915201546, 0.105996897565717, 2.17916290883742, 0.101738128945839, 0.0950860879735766, 0.0936167676896599, 0.0895459928979593, 0.571535083831571, 0.1937858687466, 0.362829566491438, 6.64158883120928, 16.7042290667909, 0.055363013399337, 45.2250279146836, 0.0517128935875855, 0.0500167044763647, 0.0428512775058219, 0.515251030665599, 7.42061693778372, 10.6286936547089, 0.163680646634254, 0.0304228868682757, 0.0293200601494461, 0.0275195763334376, 11.0741513614472, 0.0166723589854385, 0.0136916887517227, 0.0122945727900386, 0.0106811602779099, 0.00430952511405818, 0.00359866510988527, 0.00301215254047329, 0.00246264924247654, 0.0020866097207702, 0.00170724674071023, 0.00133918028616061, 0.00118537483156833, 0.000869421311893521, 0.000654332378541978
				                                                   }
		                                                   });

		int dimMax(3);
		sambada::StoreyHistograms storeyHistograms(dimMax);

		for (int i(1); i <= dimMax; ++i)
		{
			for (auto scoreG(GScores[i - 1].begin()); scoreG != GScores[i - 1].end(); ++scoreG)
			{
				storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::G, i, *scoreG);
			}

			for (auto scoreWald(WaldScores[i - 1].begin()); scoreWald != WaldScores[i - 1].end(); ++scoreWald)
			{
				storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::Wald, i, *scoreWald);
			}
		}

		for (auto scoreG(popScores[0].begin()); scoreG != popScores[0].end(); ++scoreG)
		{
			storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::GPop, dimMax, *scoreG);
		}

		for (auto scoreWald(popScores[1].begin()); scoreWald != popScores[1].end(); ++scoreWald)
		{
			storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::WaldPop, dimMax, *scoreWald);
		}

		std::ostringstream outputStream(std::ios_base::out);

		sambada::StoreyHistogramsStreamWriter writer;
		writer.write(storeyHistograms, outputStream, true);
		std::string output(outputStream.str());

		std::istringstream iss(output.c_str());

		SambadaStoreyHistogramMapper mapper;
		SambadaStoreyHistogram storeyHistogram(mapper.readStoreyHistogram(iss));

		storeyHistogram.verifieTailles(14);

		storeyHistogram.compare(expectedStoreyHistogram);

	}

	SECTION("Test that StoreyHistogramsStreamWriter uses the correct word divider")
	{
		char divider(';');

		std::vector<std::vector<sambada::reel> > GScores({
				                                                 {
						                                                 393.949951509768, 353.885363268917, 278.512496775078, 216.156931302346, 180.940391598576, 202.926694969315, 200.818381582413, 200.732817799452, 186.04478249851,  172.664962510671, 178.454149129625, 163.175093924547, 170.433242855714, 145.857925626891, 166.38209011695,  141.734405787342, 134.181356903727, 141.818753384617,  160.936242443686,  133.602628822658,  176.80528013519,  142.99264803151,   132.885100929244,  130.42295599695,   123.890473651454,  140.090340603917,  126.220521780338,  142.420296902169,  140.319054048203,   119.573005636945, 133.552891994526, 115.464151239751, 129.781587262074, 103.170074076126, 105.732655011715, 100.203139152104, 98.6993350237508, 98.9921388835725, 93.9826186690765, 91.018999657901,  94.1736191584592, 88.1397023897944, 99.7601123097304, 98.3207439558082, 142.269945680323, 81.4543331409993, 166.382388403016, 83.0733569680547, 90.5655904298121, 88.2889186171084, 72.3354143631421, 72.0365863386888, 70.1657773006597, 70.8438835309048,  70.5786711262128,  71.0131979250316, 71.9411541374465, 74.0260776888945, 67.1244915363496, 73.9553228921615, 71.4331291681609, 70.9531676012675, 64.6070801374461, 64.0371982732709, 66.5305755013484, 60.358568972232, 63.5624925119325, 58.6894592199744, 64.6973231903883, 55.380656151135, 53.6666556264024, 53.5951420515159, 58.645690152474, 52.6879936600277, 57.7957403102149, 52.6056020135212, 49.724560876745, 76.4105455312242, 50.1858060969084, 54.1603648072546, 48.2001533789776, 52.7868784435638, 47.021505400787, 42.0433605690271, 45.7957752714054, 40.1020995131078, 40.1614263538354, 39.3265601183218, 38.0778209217394, 38.6181794598155, 41.9521916771594, 41.8705059570142, 35.109251795452, 34.7242322446394, 39.7718604081135, 33.8124022549054, 33.3033899494915, 31.1477521041288, 33.4833423721856, 33.7062058510041, 32.001301235603, 28.7498460574013, 28.5207320846052, 29.264137196086, 27.2481375857658, 31.9384190129585, 25.0039693217186, 21.6095877152546, 21.2644063862291, 20.1833367724928, 20.5250712707164, 19.2262296181383, 16.4620700097188, 14.1983666361308, 16.6585215961344, 26.0390484782074, 15.0275854565216, 15.4733367900841, 13.6994365361926, 14.2477425207965, 13.39262900342, 14.2378706786969, 11.6145993788587, 11.6186015583056, 10.6502995592848, 10.250898108008, 11.4496940598331, 10.0715163810867, 10.3216163520063, 9.63427085389253, 17.7249678755857, 8.52747158095781, 8.82768794086178, 13.7175878664813, 8.45193422825594, 8.09247930492006, 7.55135091243221, 7.39296654656459, 7.44097271442081, 7.30726712694445, 6.50194525367294, 6.19110193668939, 6.21408646419422, 6.0596774557257, 6.03865328858512, 5.66982489319378, 5.54029477049573, 5.47833565388555, 5.34523901527575, 5.54084142357851, 5.04626595028753, 4.92130091015599, 4.71258734090225, 4.5730189964487, 4.43573928014962, 4.06601135556309, 3.97070440943912, 4.06412308534243, 3.74701246077336, 3.8431083105977, 3.28191854489023, 3.5530381342478, 3.03102555354337, 2.84007241682491, 2.95609268234853, 2.59599135577093, 2.53038359275706, 2.44648560419466, 2.38664606709813, 2.54990937015748, 2.40781177693248, 2.98681151795297, 2.46021918026196, 2.63080024130512, 2.05858226160402, 2.39340521446502, 2.34173870141636, 2.36374238021131, 1.65640047880311, 1.70370962346374, 1.67029446774313, 1.48449543343632, 1.39570410488545, 1.58994664187423, 1.36911200849568, 1.12225146846555, 1.33478320692097, 1.08962458406577, 1.0374536747986, 0.983984885730337, 0.958449466164666, 0.777753254379945, 0.754140341264815, 0.582159304743641, 0.51618336687693, 0.790489303602442, 0.374352460496198, 0.372480340108126, 0.346401927429724, 0.324577854921245, 0.186140381371843, 0.178788872862071, 0.131320856314687, 0.110373426144179, 0.0815353324976513, 0.0618435788875615, 0.0623536512323426, 0.0615414345309091, 0.0265022108701487, 0.00802248055674681
				                                                 },
				                                                 {       17.0791246207324, 16.6755734446276, 11.6541518883481, 14.1890330139211, 8.70436601226538, 14.0420487944288, 11.53186443759,   4.55439372818319, 3.35293027424893, 2.94117472630273, 2.19873637264715, 2.74071837275233, 2.58657569639149, 1.78484308451755, 1.96615226941026, 2.10573824844278, 2.0552902141842,  0.833700578860316, 0.791147325777615, 0.724230435902598, 0.64507324916201, 0.661274142648949, 0.415426074987863, 0.602524738974751, 0.357991684671561, 0.303886906560365, 0.188322987318088, 0.129024545103491, 0.0627333004347292, 0.0169091448838117},
				                                                 {
						                                                 16.7327582465851, 14.9519478160137, 12.1465620946101, 10.9427118491534, 8.60027214716251, 9.38301663649486, 7.06175514048107, 6.43477864237263, 8.48678318251643, 7.17929018632981, 4.87435743023752, 4.75625060959953, 4.71230031949045, 4.09126814631657, 3.84539109286561, 3.68722867612655, 3.79616304301476, 2.88153131023819,  3.41825997476485,  4.04128667941029,  3.25709422381794, 3.07948332142468,  2.52185681788296,  2.95877114090308,  2.99620791332148,  2.65275394755201,  2.60576753397663,  2.45099789871711,  2.4741513681081,    2.43933198312777, 2.30661395346453, 2.32396232395081, 2.15181934890859, 2.06645824955933, 1.98729270452816, 1.98109361731258, 1.82866024497935, 1.87620223861688, 1.57657222705598, 1.83378256075798, 1.74532464526908, 1.71370052473128, 1.64514291648743, 1.61810660841854, 1.5395209981358,  1.42118955240051, 1.34752636715621, 1.20165933576379, 1.17023890651728, 1.12942905139221, 1.0874578674327,  1.06271095654381, 1.01941693113884, 0.850210812593843, 0.798819560914808, 0.857751323756588, 0.715081713913037, 0.684479121479285, 0.673092714901941, 0.646472538801277, 0.63412820885236, 0.601419974791952, 0.552499803755609, 0.535945993511518, 0.539113178317962, 0.531951155061961, 0.486872144555491, 0.51469960827194, 0.449396361387358, 0.474159180925085, 0.408451155558964, 0.38512160103005, 0.389489859715923, 0.348018247331424, 0.358667887341085, 0.358935983145898, 0.481300722445127, 0.339656013793501, 0.331909948770772, 0.346495675863821, 0.313500575440685, 0.288043096836475, 0.391716726100157, 0.29021353067651, 0.275540812126565, 0.272711125497722, 0.264448476216444, 0.252477811146036, 0.240403722873225, 0.222796933263908, 0.218630005631837, 0.220781980407082, 0.275260773385895, 0.203330634805752, 0.201418113006469, 0.195529992959223, 0.199035222293986, 0.191697489181593, 0.18852730486401, 0.182070671967949, 0.173898053882112, 0.169365836007501, 0.137985819760502, 0.136815048297876, 0.135855656484637, 0.129455107790022, 0.128899332972367, 0.123752907627022, 0.117088749391655, 0.111258455390839, 0.111476717141045, 0.105591690772712, 0.10572171082697, 0.103662708297634, 0.101777918380321, 0.0948415542342218, 0.0936061587992754, 0.0891243953428784, 0.103466246428937, 0.0999811316084305, 0.09519349212718, 0.0720165131880321, 0.0704525497592385, 0.0554287911890015, 0.0532857348097195, 0.0525618139704562, 0.0492864459106954, 0.0428688739580139, 0.0350462795122439, 0.0327983201436837, 0.0314396353933262, 0.0307155863370099, 0.030367642005217, 0.0293285980617384, 0.0274944245499, 0.0184225385135051, 0.0166480415564365, 0.0136538181333208, 0.0122873798907221, 0.0106850652329058, 0.00430316354027127, 0.00359681688553337, 0.00300829998519703, 0.00245608875286507, 0.00208598889241784, 0.00170675502408812, 0.00133940809303112, 0.00118578230876665, 0.000869578624019596, 0.000654287202678461
				                                                 }
		                                                 });

		std::vector<std::vector<sambada::reel> > WaldScores({
				                                                    {
						                                                    258.264600261147, 246.405288836367, 212.061267713183, 172.562696631213, 150.184842034151, 148.428318228663, 147.604225832285, 143.731698774969, 141.988196814782, 139.170569077467, 138.112317173824, 130.951359335134, 126.856291790207, 122.588537123702, 119.821524692964, 117.105570897479, 115.434334398785, 114.703190922502,  111.211799305358,  110.740576620846, 110.229320372175,  110.203752260097,  110.083797860646,  105.370670224761,  104.56272395389,   103.822080585162,  103.807961596017,  103.051006869041,   101.911328027795,   99.6223694537238, 98.2332416220329, 97.7333629713996, 96.0636179141156, 88.0179060181028, 85.7771332668375, 85.2461728249231, 84.5752040559164, 83.3182222978706, 81.311131560197, 79.4777608509313, 77.9842911820666, 77.7271254090635, 77.6622299411224, 77.6420921639193, 75.4546036086265, 73.1956022464983, 73.1401167273493, 72.2783323717332, 70.1063947051334, 68.7994177775958, 65.5345490973509, 64.395993129384,  63.190637170301,  63.085695681139,   62.9774747380425,  62.6754065829946, 62.0763457116979, 60.9710292890915, 60.8415097572546, 60.3157517156913, 59.3314817906474, 58.974811520801, 58.3014738923693, 57.935450494516, 56.9092810368456, 56.0559475988607, 54.4880312625743, 53.4488452722908, 52.2709861203422, 50.1981804625788, 50.0012653539051, 49.4371813461718, 49.1643759749983, 49.0477811419813, 48.5722648001888, 48.4658241955269, 47.8367942899173, 46.8919337920812, 46.7361898924846, 45.0937050578169, 44.7903697263652, 44.4385186016128, 40.5035318476328, 39.3634941434121, 38.7080988325024, 38.1566501875069, 37.8075322890678, 36.7678123623005, 36.1825658599063, 36.1171999142192, 35.7445154865424, 35.6479909009792, 35.188402329961, 34.8422174992907, 34.513426420426, 32.2794018204241, 31.9218435323404, 29.8723446818403, 29.8223982774737, 29.6758442461429, 28.5851813227425, 27.6629618832722, 27.237024935442, 27.0449171788149, 26.1060471161396, 24.5786944721275, 24.1499230180474, 21.3262282627104, 20.6265548002826, 19.9183212974271, 19.7455986806562, 17.6533270922097, 16.0327577636289, 15.7798079868791, 15.4733289606568, 14.3373522270674, 14.2555679063826, 14.1848992989625, 13.4333868962959, 12.9039368355601, 12.7412683052736, 12.6018200057542, 11.4562480118976, 11.415663922337, 10.5034569254555, 10.2178929041793, 10.0474588473911, 10.0155561880237, 9.34592947090753, 9.26981025022267, 8.89400179651615, 8.44321244656877, 8.44299906284602, 8.33388907530749, 8.3310734961936, 7.99570146187275, 7.38640418813105, 7.33811534352839, 7.25945609357655, 7.23666913549503, 6.28782836379681, 6.19343355517015, 6.16050583440334, 6.02535752019399, 5.97386670125258, 5.54314590784898, 5.48861991809781, 5.3683468198136, 5.28227477845912, 5.10485996819791, 5.01739011959191, 4.87758622580074, 4.59386869216882, 4.4491569906142, 4.40828541237771, 4.11368134680868, 4.0337235122348, 3.86005064284758, 3.71444890674543, 3.37437620199707, 3.26859242757474, 3.0769888463192, 2.93925284056403, 2.89119365888461, 2.82556703504221, 2.58073951704144, 2.55504591891739, 2.50020445797354, 2.49230008678924, 2.48490672287023, 2.40313464629183, 2.38839577167827, 2.38633078419243, 2.38294707825187, 2.37528896824304, 2.30701925246025, 2.21857780121161, 2.02154832682789, 1.75340014627323, 1.69673661408632, 1.6663066280952, 1.41882981856329, 1.41730289013083, 1.40052705196261, 1.39559550096401, 1.34579681438192, 1.32997901957808, 1.17798121148932, 1.03484208512975, 0.981315389124832, 0.961212910343522, 0.838391940087559, 0.79322321147917, 0.620091559920397, 0.522131909498495, 0.470649475665961, 0.387500902234686, 0.370254682977214, 0.348379799526421, 0.34590164273308, 0.188066241653452, 0.132361713782867, 0.130961551162071, 0.110105371206388, 0.0807827526952061, 0.0629268870336548, 0.0623783592893298, 0.0593151203000924, 0.0265013285821112, 0.00806386929933381
				                                                    },
				                                                    {       16.2299323009388, 14.084993307253,  11.486399127526,  10.0390685989543, 8.46712864190336, 8.18056799088184, 7.32686691783119, 4.60793423249846, 3.63139216454041, 2.8185936414377,  2.78211271909262, 2.76914253916819, 2.70398674451952, 2.0780791594553,  2.00486260728186, 1.85671080795847, 1.84925976357078, 0.901879960823952, 0.832807005567993, 0.81390339156979, 0.690025256249808, 0.601307990038113, 0.430656248473507, 0.408498669311501, 0.360039848905913, 0.313635253114071, 0.190291685280185, 0.0966902762057164, 0.0627585210187139, 0.0169818135716442},
				                                                    {
						                                                    16.7057144613222, 14.7505192052027, 11.9016103948436, 10.618396148621,  8.05350649551352, 7.33401667486825, 6.66137658835453, 6.32620350234818, 6.31594416453469, 5.04518796305885, 4.90793311647243, 4.82913144240392, 4.64396538024632, 4.14311480208551, 3.9038143614346,  3.73898180031013, 3.63014263056341, 3.50677812073047,  3.45275009042105,  3.44979110372373, 3.15092106383462,  3.08761485066824,  3.01944628594831,  2.88916363903907,  2.8592614574653,   2.66974667592562,  2.60453978552901,  2.51438885863864,   2.49849999743817,   2.49801262739527, 2.40766875634933, 2.29028438151224, 2.15898638975217, 2.14560431334926, 2.07044215030533, 1.95418473418235, 1.88888594754324, 1.88650616172238, 1.8198721207564, 1.81193155521888, 1.75909911115049, 1.69745221456066, 1.62846548699934, 1.44782527185428, 1.4064548383697,  1.402257579811,   1.35519843738159, 1.19200677769228, 1.1758166909225,  1.1093815936921,  1.08911002693294, 1.05248084609684, 1.01504412584237, 0.964101350067133, 0.836203780534342, 0.769820542419538, 0.711014107759879, 0.704565783258251, 0.677095303890912, 0.676804631539347, 0.622458157794941, 0.605564274894241, 0.551713329151314, 0.540278693926871, 0.535068804226974, 0.534083658593357, 0.486997493094134, 0.47342904145533, 0.466691322509271, 0.466314513482617, 0.406713874644601, 0.398807667014405, 0.392418978084885, 0.35982835590929, 0.3593186813743, 0.358356148140949, 0.340050205426053, 0.33588919183582, 0.335315055145836, 0.333069641567544, 0.312911673525574, 0.293959092019542, 0.287502292456675, 0.287114929535302, 0.274679459410518, 0.270069486428297, 0.263317153901112, 0.252336888625688, 0.247082018985189, 0.223696327749984, 0.22289007378723, 0.220453700332539, 0.216455951289174, 0.204189576112103, 0.203816856242006, 0.195866800084742, 0.193318046531763, 0.19150467861053, 0.188253966476271, 0.183148949206966, 0.174148552065552, 0.171052673157679, 0.138830698342532, 0.135806003856863, 0.129894012486075, 0.129137032920589, 0.128929674102549, 0.124212659761899, 0.116332776348904, 0.110977443853375, 0.110657427410986, 0.106322915201546, 0.105996897565717, 0.10451350853217, 0.101738128945839, 0.0950860879735766, 0.0936167676896599, 0.0895459928979593, 0.0792479340809267, 0.0774187338193672, 0.0738514135266331, 0.072636059897768, 0.0723717762159917, 0.055363013399337, 0.0517497657333976, 0.0517128935875855, 0.0500167044763647, 0.0428512775058219, 0.0352569789652512, 0.0326147198007676, 0.0315605005571588, 0.0308882793101364, 0.0304228868682757, 0.0293200601494461, 0.0275195763334376, 0.0184817721306083, 0.0166723589854385, 0.0136916887517227, 0.0122945727900386, 0.0106811602779099, 0.00430952511405818, 0.00359866510988527, 0.00301215254047329, 0.00246264924247654, 0.0020866097207702, 0.00170724674071023, 0.00133918028616061, 0.00118537483156833, 0.000869421311893521, 0.000654332378541978
				                                                    }
		                                                    });

		std::vector<std::vector<sambada::reel> > popScores({
				                                                   {
						                                                   47.5508020099315, 17.8746547565823, 41.3946973283983, 13.2273316275405, 8.60027214716251, 9.38301663649486, 7.06175514048107, 6.43477864237263, 60.9753162647014, 9.46054160086123, 4.87435743023752, 4.75625060959953, 4.71230031949045, 5.07212153414218, 5.76215579054019, 3.68722867612655, 6.40749147073564, 17.6056374560984, 9.07592131335366, 5.07963522409273, 3.25709422381794, 3.07948332142468, 5.99775666160588, 2.95877114090308, 2.99620791332148, 2.65275394755201, 8.49670853015789, 12.6532301474047, 2.4741513681081,  2.43933198312777, 3.9477895884072,  2.32396232395081, 2.15181934890859, 3.92003576871639, 20.2534422625565, 1.98109361731258, 13.6480430928434, 13.5628581284628, 4.27541903406859, 1.83378256075798, 13.9187170792929, 49.0912298822102, 1.64514291648743, 2.95266037804299, 12.9170895335112, 38.20134419201,   1.34752636715621, 1.20165933576379, 7.3390942002236,  1.12942905139221, 9.62218644794984, 1.06271095654381, 1.01941693113884, 1.9037098376989,  2.10568451757081, 5.74248068468989, 1.98497615834549, 0.711602905646942, 0.673092714901941, 0.809344489206751, 0.63412820885236, 0.620483123303302, 0.552499803755609, 0.535945993511518, 0.539113178317962, 0.531951155061961, 0.486872144555491, 1.03661705899788, 4.860531961481, 11.7091360121462, 1.63428799949418, 0.910882391787368, 0.389489859715923, 0.545043464147966, 0.358667887341085, 0.358935983145898, 0.819294943689897, 0.339656013793501, 2.56260400306905, 7.7126808083907, 0.313500575440685, 0.288043096836475, 3.71285446879551, 0.29021353067651, 0.275540812126565, 0.272711125497722, 0.264448476216444, 0.252477811146036, 0.343637586605041, 2.47979971862264, 0.218630005631837, 1.05357082418845, 2.09230010354733, 2.52882922603681, 0.201418113006469, 0.195529992959223, 0.199035222293986, 0.191697489181593, 0.18852730486401, 20.1521431603426, 0.173898053882112, 0.195955008342025, 15.0508415854339, 0.136815048297876, 19.0563384681665, 0.129455107790022, 0.128899332972367, 0.123752907627022, 0.117088749391655, 0.111258455390839, 0.111476717141045, 0.105591690772712, 0.10572171082697, 2.20414882775776, 0.101777918380321, 0.0948415542342218, 0.0936061587992754, 0.0891243953428784, 0.520716267685785, 0.190741899003029, 0.366561509310657, 6.65955823929983, 16.8098670408702, 0.0554287911890015, 55.3446999942083, 0.0525618139704562, 0.0492864459106954, 0.0428688739580139, 0.517722496794931, 7.93659103398238, 11.2176856416345, 0.164087439094715, 0.030367642005217, 0.0293285980617384, 0.0274944245499, 11.3346413757181, 0.0166480415564365, 0.0136538181333208, 0.0122873798907221, 0.0106850652329058, 0.00430316354027127, 0.00359681688553337, 0.00300829998519703, 0.00245608875286507, 0.00208598889241784, 0.00170675502408812, 0.00133940809303112, 0.00118578230876665, 0.000869578624019596, 0.000654287202678461
				                                                   },
				                                                   {
						                                                   39.8279822628157, 17.5355078954831, 35.7750763561748, 13.1079784454148, 8.05350649551352, 9.02870635119507, 6.80159976120709, 6.32620350234818, 54.2708675504136, 9.05781176426883, 4.90793311647243, 4.82913144240392, 4.64396538024632, 5.00450667262304, 5.63509017629403, 3.73898180031013, 6.09315438937869, 17.8373307233592, 8.92631263729097, 5.00798584426854, 3.15092106383462, 3.08761485066824, 5.87269916338002, 2.88916363903907, 2.8592614574653,  2.66974667592562, 8.3641016468639,  12.2904428712594, 2.49849999743817, 2.49801262739527, 3.94245013347282, 2.29028438151224, 2.15898638975217, 3.76848251137127, 18.6396940589113, 1.95418473418235, 13.2711768218222, 12.7612109924091, 4.39622917270267, 1.81193155521888, 13.4948250897266, 44.5742167958631, 1.62846548699934, 2.95765038087526, 12.8723423997447, 35.0903369076723, 1.35519843738159, 1.19200677769228, 7.08779237826081, 1.1093815936921,  9.40622899216253, 1.05248084609684, 1.01504412584237, 1.83714665347872, 2.07594900763496, 5.83442557928908, 1.98613554480328, 0.704565783258251, 0.677095303890912, 0.805962100042454, 0.622458157794941, 0.618668806128414, 0.551713329151314, 0.540278693926871, 0.535068804226974, 0.534083658593357, 0.486997493094134, 1.04123302888657, 4.74244978414205, 11.232357660281, 1.63601110635403, 0.909953797510421, 0.392418978084885, 0.54097412059982, 0.3593186813743, 0.358356148140949, 0.836088455053715, 0.33588919183582, 2.53218086562595, 7.352987752017, 0.312911673525574, 0.293959092019542, 4.12103240008625, 0.287114929535302, 0.274679459410518, 0.270069486428297, 0.263317153901112, 0.252336888625688, 0.339848863234197, 2.43484655243785, 0.22289007378723, 1.05434364763425, 2.05380650005053, 2.51914909418609, 0.203816856242006, 0.195866800084742, 0.193318046531763, 0.19150467861053, 0.188253966476271, 18.7315330194447, 0.174148552065552, 0.196355865611352, 14.6118469286213, 0.135806003856863, 18.5497220515591, 0.129137032920589, 0.128929674102549, 0.124212659761899, 0.116332776348904, 0.110977443853375, 0.110657427410986, 0.106322915201546, 0.105996897565717, 2.17916290883742, 0.101738128945839, 0.0950860879735766, 0.0936167676896599, 0.0895459928979593, 0.571535083831571, 0.1937858687466, 0.362829566491438, 6.64158883120928, 16.7042290667909, 0.055363013399337, 45.2250279146836, 0.0517128935875855, 0.0500167044763647, 0.0428512775058219, 0.515251030665599, 7.42061693778372, 10.6286936547089, 0.163680646634254, 0.0304228868682757, 0.0293200601494461, 0.0275195763334376, 11.0741513614472, 0.0166723589854385, 0.0136916887517227, 0.0122945727900386, 0.0106811602779099, 0.00430952511405818, 0.00359866510988527, 0.00301215254047329, 0.00246264924247654, 0.0020866097207702, 0.00170724674071023, 0.00133918028616061, 0.00118537483156833, 0.000869421311893521, 0.000654332378541978
				                                                   }
		                                                   });

		int dimMax(3);
		sambada::StoreyHistograms storeyHistograms(dimMax);

		for (int i(1); i <= dimMax; ++i)
		{
			for (auto scoreG(GScores[i - 1].begin()); scoreG != GScores[i - 1].end(); ++scoreG)
			{
				storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::G, i, *scoreG);
			}

			for (auto scoreWald(WaldScores[i - 1].begin()); scoreWald != WaldScores[i - 1].end(); ++scoreWald)
			{
				storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::Wald, i, *scoreWald);
			}
		}

		for (auto scoreG(popScores[0].begin()); scoreG != popScores[0].end(); ++scoreG)
		{
			storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::GPop, dimMax, *scoreG);
		}

		for (auto scoreWald(popScores[1].begin()); scoreWald != popScores[1].end(); ++scoreWald)
		{
			storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::WaldPop, dimMax, *scoreWald);
		}

		std::ostringstream outputStream(std::ios_base::out);

		sambada::StoreyHistogramsStreamWriter writer;
		writer.write(storeyHistograms, outputStream, true, divider);
		std::string output(outputStream.str());

		int countDivider(0);
		for (auto read(output.cbegin()); read != output.cend(); ++read)
		{
			if (*read == divider)
			{
				++countDivider;
			}
		}

		CHECK(countDivider == 1536);
	}

	SECTION("Test that StoreyHistogramsStreamWriter doesn't write population data to output stream when not requested")
	{
		SambadaStoreyHistogram expectedStoreyHistogram;

		expectedStoreyHistogram.etiquettes = {"P-valeurs", "Scores", "G1", "GOrphelins1", "Wald1", "WaldOrphelins1", "G2", "GOrphelins2", "Wald2", "WaldOrphelins2", "G3", "GOrphelins3", "Wald3", "WaldOrphelins3"};

		expectedStoreyHistogram.header = {{0.95,                0.94,                0.93,              0.92,              0.91,              0.9,                0.89,               0.88,               0.87,               0.86,               0.85,               0.84,              0.83,               0.82,               0.81,               0.8,                0.79,               0.78,               0.77,               0.76,               0.75,              0.74,              0.73,              0.72,              0.71,              0.7,               0.69,              0.68,              0.67,             0.66,              0.65,              0.64,              0.63,             0.62,             0.61,              0.6,               0.59,              0.58,              0.57,              0.56,              0.55,             0.54,              0.53,              0.52,              0.51,              0.5,               0.49,              0.48,              0.47,              0.46,              0.45,              0.44, 0.43, 0.42, 0.41, 0.4, 0.39, 0.38, 0.37, 0.36, 0.35, 0.34, 0.33, 0.32, 0.31, 0.3, 0.29, 0.28, 0.27, 0.26, 0.25, 0.24, 0.23, 0.22, 0.21, 0.2, 0.19, 0.18, 0.17, 0.16, 0.15, 0.14, 0.13, 0.12, 0.11, 0.1, 0.09, 0.08, 0.07, 0.0599999999999999, 0.0499999999999999, 0.0399999999999999, 0.0299999999999999, 0.0199999999999999, 0.0099999999999999, 0},
		                                  {0.00393214000001953, 0.00566555214052741, 0.007716715544952, 0.010086932215776, 0.012777711671053, 0.0157907740934313, 0.0191280539398315, 0.0227917040277124, 0.0267841001161233, 0.0311078460021464, 0.0357657791558977, 0.040760976920001, 0.0460967633024078, 0.0517767163946213, 0.0578046764508421, 0.0641847546673016, 0.0709213427051411, 0.0780191230046582, 0.0854830799436345, 0.0933185118978289, 0.101531044267622, 0.110126643541314, 0.119111632472776, 0.128492706459102, 0.138276951212761, 0.148471861832546, 0.159085363388553, 0.170125833148597, 0.18160212458709, 0.193523593332646, 0.205900125227766, 0.218742166693153, 0.23206075761083, 0.24586756696459, 0.260174931503893, 0.274995897728456, 0.290344267526239, 0.306234647837711, 0.322682504765163, 0.339704222598183, 0.35731716828632, 0.375539761958745, 0.394391554169761, 0.413893310640177, 0.434067105369943, 0.454936423119573, 0.476526272399809, 0.498863310274476, 0.521975980474872, 0.545894666550918, 0.570651862051189, 0.596282360039052, 0.622823464625417, 0.650315227642454, 0.678800714112448, 0.708326300800794, 0.738942012906212, 0.770701904864674, 0.803664492364912, 0.837893244041483, 0.87345714298923, 0.910431330311541, 0.94889784547952, 0.988946481478024, 1.03067577672932, 1.07419417085759, 1.11962135781185, 1.16708987813886, 1.21674700288959, 1.2687569755773, 1.32330369693147, 1.38059396152976, 1.44086138805315, 1.50437122924054, 1.57142630852761, 1.64237441514982, 1.7176176092514, 1.79762406036565, 1.88294329343061, 1.97422608959095, 2.07225085582224, 2.17795915885414, 2.29250452609228, 2.41732093045561, 2.55422131249636, 2.70554345409542, 2.874373395996, 3.06490172007636, 3.28302028675954, 3.5373845964626, 3.84145882069412, 4.2178845879214, 4.70929224688511, 5.41189443105435, 6.63489660102123}};

		expectedStoreyHistogram.valeurs = {{0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 3, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 2, 0, 1, 1, 1, 0, 0, 0, 2, 1, 1, 0, 1, 3, 0, 0, 0, 1, 0, 0, 5, 4, 2, 1, 3, 1, 0, 2, 4, 2, 4, 9, 140},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 3, 0, 0, 1, 0, 0, 1, 0, 0, 2, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 2, 0, 1, 0, 0, 1, 0, 0, 2, 4, 0, 0, 0, 2, 1, 0, 0, 1, 0, 1, 6, 3, 2, 1, 2, 2, 1, 1, 3, 3, 5, 7, 140},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 7},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1, 1, 0, 0, 0, 1, 3, 0, 0, 0, 1, 0, 1, 0, 0, 7},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {9, 1, 0, 0, 2, 1, 2, 0, 0, 4, 3, 0, 1, 1, 3, 0, 1, 1, 0, 1, 4, 5, 3, 1, 5, 0, 0, 1, 1, 3, 4, 1, 2, 1, 1, 2, 4, 0, 1, 2, 2, 2, 3, 1, 0, 1, 1, 2, 1, 3, 1, 0, 1, 2, 1, 1, 1, 0, 1, 0, 2, 0, 0, 0, 1, 1, 1, 1, 2, 0, 0, 1, 1, 0, 1, 2, 2, 1, 3, 0, 3, 1, 0, 2, 4, 2, 0, 3, 2, 1, 2, 3, 0, 3, 1, 9},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		                                   {9, 1, 0, 0, 2, 1, 2, 0, 0, 4, 3, 0, 1, 3, 1, 0, 0, 4, 1, 1, 2, 4, 3, 1, 4, 1, 0, 0, 2, 4, 3, 1, 3, 0, 2, 3, 2, 1, 1, 3, 1, 3, 1, 2, 0, 0, 3, 1, 0, 3, 1, 0, 2, 0, 2, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 2, 0, 2, 0, 0, 1, 2, 1, 0, 1, 1, 1, 2, 3, 1, 2, 1, 1, 3, 2, 1, 2, 2, 3, 2, 2, 1, 3, 2, 7},
		                                   {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
		};


		std::vector<std::vector<sambada::reel> > GScores({
				                                                 {
						                                                 393.949951509768, 353.885363268917, 278.512496775078, 216.156931302346, 180.940391598576, 202.926694969315, 200.818381582413, 200.732817799452, 186.04478249851,  172.664962510671, 178.454149129625, 163.175093924547, 170.433242855714, 145.857925626891, 166.38209011695,  141.734405787342, 134.181356903727, 141.818753384617,  160.936242443686,  133.602628822658,  176.80528013519,  142.99264803151,   132.885100929244,  130.42295599695,   123.890473651454,  140.090340603917,  126.220521780338,  142.420296902169,  140.319054048203,   119.573005636945, 133.552891994526, 115.464151239751, 129.781587262074, 103.170074076126, 105.732655011715, 100.203139152104, 98.6993350237508, 98.9921388835725, 93.9826186690765, 91.018999657901,  94.1736191584592, 88.1397023897944, 99.7601123097304, 98.3207439558082, 142.269945680323, 81.4543331409993, 166.382388403016, 83.0733569680547, 90.5655904298121, 88.2889186171084, 72.3354143631421, 72.0365863386888, 70.1657773006597, 70.8438835309048,  70.5786711262128,  71.0131979250316, 71.9411541374465, 74.0260776888945, 67.1244915363496, 73.9553228921615, 71.4331291681609, 70.9531676012675, 64.6070801374461, 64.0371982732709, 66.5305755013484, 60.358568972232, 63.5624925119325, 58.6894592199744, 64.6973231903883, 55.380656151135, 53.6666556264024, 53.5951420515159, 58.645690152474, 52.6879936600277, 57.7957403102149, 52.6056020135212, 49.724560876745, 76.4105455312242, 50.1858060969084, 54.1603648072546, 48.2001533789776, 52.7868784435638, 47.021505400787, 42.0433605690271, 45.7957752714054, 40.1020995131078, 40.1614263538354, 39.3265601183218, 38.0778209217394, 38.6181794598155, 41.9521916771594, 41.8705059570142, 35.109251795452, 34.7242322446394, 39.7718604081135, 33.8124022549054, 33.3033899494915, 31.1477521041288, 33.4833423721856, 33.7062058510041, 32.001301235603, 28.7498460574013, 28.5207320846052, 29.264137196086, 27.2481375857658, 31.9384190129585, 25.0039693217186, 21.6095877152546, 21.2644063862291, 20.1833367724928, 20.5250712707164, 19.2262296181383, 16.4620700097188, 14.1983666361308, 16.6585215961344, 26.0390484782074, 15.0275854565216, 15.4733367900841, 13.6994365361926, 14.2477425207965, 13.39262900342, 14.2378706786969, 11.6145993788587, 11.6186015583056, 10.6502995592848, 10.250898108008, 11.4496940598331, 10.0715163810867, 10.3216163520063, 9.63427085389253, 17.7249678755857, 8.52747158095781, 8.82768794086178, 13.7175878664813, 8.45193422825594, 8.09247930492006, 7.55135091243221, 7.39296654656459, 7.44097271442081, 7.30726712694445, 6.50194525367294, 6.19110193668939, 6.21408646419422, 6.0596774557257, 6.03865328858512, 5.66982489319378, 5.54029477049573, 5.47833565388555, 5.34523901527575, 5.54084142357851, 5.04626595028753, 4.92130091015599, 4.71258734090225, 4.5730189964487, 4.43573928014962, 4.06601135556309, 3.97070440943912, 4.06412308534243, 3.74701246077336, 3.8431083105977, 3.28191854489023, 3.5530381342478, 3.03102555354337, 2.84007241682491, 2.95609268234853, 2.59599135577093, 2.53038359275706, 2.44648560419466, 2.38664606709813, 2.54990937015748, 2.40781177693248, 2.98681151795297, 2.46021918026196, 2.63080024130512, 2.05858226160402, 2.39340521446502, 2.34173870141636, 2.36374238021131, 1.65640047880311, 1.70370962346374, 1.67029446774313, 1.48449543343632, 1.39570410488545, 1.58994664187423, 1.36911200849568, 1.12225146846555, 1.33478320692097, 1.08962458406577, 1.0374536747986, 0.983984885730337, 0.958449466164666, 0.777753254379945, 0.754140341264815, 0.582159304743641, 0.51618336687693, 0.790489303602442, 0.374352460496198, 0.372480340108126, 0.346401927429724, 0.324577854921245, 0.186140381371843, 0.178788872862071, 0.131320856314687, 0.110373426144179, 0.0815353324976513, 0.0618435788875615, 0.0623536512323426, 0.0615414345309091, 0.0265022108701487, 0.00802248055674681
				                                                 },
				                                                 {       17.0791246207324, 16.6755734446276, 11.6541518883481, 14.1890330139211, 8.70436601226538, 14.0420487944288, 11.53186443759,   4.55439372818319, 3.35293027424893, 2.94117472630273, 2.19873637264715, 2.74071837275233, 2.58657569639149, 1.78484308451755, 1.96615226941026, 2.10573824844278, 2.0552902141842,  0.833700578860316, 0.791147325777615, 0.724230435902598, 0.64507324916201, 0.661274142648949, 0.415426074987863, 0.602524738974751, 0.357991684671561, 0.303886906560365, 0.188322987318088, 0.129024545103491, 0.0627333004347292, 0.0169091448838117},
				                                                 {
						                                                 16.7327582465851, 14.9519478160137, 12.1465620946101, 10.9427118491534, 8.60027214716251, 9.38301663649486, 7.06175514048107, 6.43477864237263, 8.48678318251643, 7.17929018632981, 4.87435743023752, 4.75625060959953, 4.71230031949045, 4.09126814631657, 3.84539109286561, 3.68722867612655, 3.79616304301476, 2.88153131023819,  3.41825997476485,  4.04128667941029,  3.25709422381794, 3.07948332142468,  2.52185681788296,  2.95877114090308,  2.99620791332148,  2.65275394755201,  2.60576753397663,  2.45099789871711,  2.4741513681081,    2.43933198312777, 2.30661395346453, 2.32396232395081, 2.15181934890859, 2.06645824955933, 1.98729270452816, 1.98109361731258, 1.82866024497935, 1.87620223861688, 1.57657222705598, 1.83378256075798, 1.74532464526908, 1.71370052473128, 1.64514291648743, 1.61810660841854, 1.5395209981358,  1.42118955240051, 1.34752636715621, 1.20165933576379, 1.17023890651728, 1.12942905139221, 1.0874578674327,  1.06271095654381, 1.01941693113884, 0.850210812593843, 0.798819560914808, 0.857751323756588, 0.715081713913037, 0.684479121479285, 0.673092714901941, 0.646472538801277, 0.63412820885236, 0.601419974791952, 0.552499803755609, 0.535945993511518, 0.539113178317962, 0.531951155061961, 0.486872144555491, 0.51469960827194, 0.449396361387358, 0.474159180925085, 0.408451155558964, 0.38512160103005, 0.389489859715923, 0.348018247331424, 0.358667887341085, 0.358935983145898, 0.481300722445127, 0.339656013793501, 0.331909948770772, 0.346495675863821, 0.313500575440685, 0.288043096836475, 0.391716726100157, 0.29021353067651, 0.275540812126565, 0.272711125497722, 0.264448476216444, 0.252477811146036, 0.240403722873225, 0.222796933263908, 0.218630005631837, 0.220781980407082, 0.275260773385895, 0.203330634805752, 0.201418113006469, 0.195529992959223, 0.199035222293986, 0.191697489181593, 0.18852730486401, 0.182070671967949, 0.173898053882112, 0.169365836007501, 0.137985819760502, 0.136815048297876, 0.135855656484637, 0.129455107790022, 0.128899332972367, 0.123752907627022, 0.117088749391655, 0.111258455390839, 0.111476717141045, 0.105591690772712, 0.10572171082697, 0.103662708297634, 0.101777918380321, 0.0948415542342218, 0.0936061587992754, 0.0891243953428784, 0.103466246428937, 0.0999811316084305, 0.09519349212718, 0.0720165131880321, 0.0704525497592385, 0.0554287911890015, 0.0532857348097195, 0.0525618139704562, 0.0492864459106954, 0.0428688739580139, 0.0350462795122439, 0.0327983201436837, 0.0314396353933262, 0.0307155863370099, 0.030367642005217, 0.0293285980617384, 0.0274944245499, 0.0184225385135051, 0.0166480415564365, 0.0136538181333208, 0.0122873798907221, 0.0106850652329058, 0.00430316354027127, 0.00359681688553337, 0.00300829998519703, 0.00245608875286507, 0.00208598889241784, 0.00170675502408812, 0.00133940809303112, 0.00118578230876665, 0.000869578624019596, 0.000654287202678461
				                                                 }
		                                                 });

		std::vector<std::vector<sambada::reel> > WaldScores({
				                                                    {
						                                                    258.264600261147, 246.405288836367, 212.061267713183, 172.562696631213, 150.184842034151, 148.428318228663, 147.604225832285, 143.731698774969, 141.988196814782, 139.170569077467, 138.112317173824, 130.951359335134, 126.856291790207, 122.588537123702, 119.821524692964, 117.105570897479, 115.434334398785, 114.703190922502,  111.211799305358,  110.740576620846, 110.229320372175,  110.203752260097,  110.083797860646,  105.370670224761,  104.56272395389,   103.822080585162,  103.807961596017,  103.051006869041,   101.911328027795,   99.6223694537238, 98.2332416220329, 97.7333629713996, 96.0636179141156, 88.0179060181028, 85.7771332668375, 85.2461728249231, 84.5752040559164, 83.3182222978706, 81.311131560197, 79.4777608509313, 77.9842911820666, 77.7271254090635, 77.6622299411224, 77.6420921639193, 75.4546036086265, 73.1956022464983, 73.1401167273493, 72.2783323717332, 70.1063947051334, 68.7994177775958, 65.5345490973509, 64.395993129384,  63.190637170301,  63.085695681139,   62.9774747380425,  62.6754065829946, 62.0763457116979, 60.9710292890915, 60.8415097572546, 60.3157517156913, 59.3314817906474, 58.974811520801, 58.3014738923693, 57.935450494516, 56.9092810368456, 56.0559475988607, 54.4880312625743, 53.4488452722908, 52.2709861203422, 50.1981804625788, 50.0012653539051, 49.4371813461718, 49.1643759749983, 49.0477811419813, 48.5722648001888, 48.4658241955269, 47.8367942899173, 46.8919337920812, 46.7361898924846, 45.0937050578169, 44.7903697263652, 44.4385186016128, 40.5035318476328, 39.3634941434121, 38.7080988325024, 38.1566501875069, 37.8075322890678, 36.7678123623005, 36.1825658599063, 36.1171999142192, 35.7445154865424, 35.6479909009792, 35.188402329961, 34.8422174992907, 34.513426420426, 32.2794018204241, 31.9218435323404, 29.8723446818403, 29.8223982774737, 29.6758442461429, 28.5851813227425, 27.6629618832722, 27.237024935442, 27.0449171788149, 26.1060471161396, 24.5786944721275, 24.1499230180474, 21.3262282627104, 20.6265548002826, 19.9183212974271, 19.7455986806562, 17.6533270922097, 16.0327577636289, 15.7798079868791, 15.4733289606568, 14.3373522270674, 14.2555679063826, 14.1848992989625, 13.4333868962959, 12.9039368355601, 12.7412683052736, 12.6018200057542, 11.4562480118976, 11.415663922337, 10.5034569254555, 10.2178929041793, 10.0474588473911, 10.0155561880237, 9.34592947090753, 9.26981025022267, 8.89400179651615, 8.44321244656877, 8.44299906284602, 8.33388907530749, 8.3310734961936, 7.99570146187275, 7.38640418813105, 7.33811534352839, 7.25945609357655, 7.23666913549503, 6.28782836379681, 6.19343355517015, 6.16050583440334, 6.02535752019399, 5.97386670125258, 5.54314590784898, 5.48861991809781, 5.3683468198136, 5.28227477845912, 5.10485996819791, 5.01739011959191, 4.87758622580074, 4.59386869216882, 4.4491569906142, 4.40828541237771, 4.11368134680868, 4.0337235122348, 3.86005064284758, 3.71444890674543, 3.37437620199707, 3.26859242757474, 3.0769888463192, 2.93925284056403, 2.89119365888461, 2.82556703504221, 2.58073951704144, 2.55504591891739, 2.50020445797354, 2.49230008678924, 2.48490672287023, 2.40313464629183, 2.38839577167827, 2.38633078419243, 2.38294707825187, 2.37528896824304, 2.30701925246025, 2.21857780121161, 2.02154832682789, 1.75340014627323, 1.69673661408632, 1.6663066280952, 1.41882981856329, 1.41730289013083, 1.40052705196261, 1.39559550096401, 1.34579681438192, 1.32997901957808, 1.17798121148932, 1.03484208512975, 0.981315389124832, 0.961212910343522, 0.838391940087559, 0.79322321147917, 0.620091559920397, 0.522131909498495, 0.470649475665961, 0.387500902234686, 0.370254682977214, 0.348379799526421, 0.34590164273308, 0.188066241653452, 0.132361713782867, 0.130961551162071, 0.110105371206388, 0.0807827526952061, 0.0629268870336548, 0.0623783592893298, 0.0593151203000924, 0.0265013285821112, 0.00806386929933381
				                                                    },
				                                                    {       16.2299323009388, 14.084993307253,  11.486399127526,  10.0390685989543, 8.46712864190336, 8.18056799088184, 7.32686691783119, 4.60793423249846, 3.63139216454041, 2.8185936414377,  2.78211271909262, 2.76914253916819, 2.70398674451952, 2.0780791594553,  2.00486260728186, 1.85671080795847, 1.84925976357078, 0.901879960823952, 0.832807005567993, 0.81390339156979, 0.690025256249808, 0.601307990038113, 0.430656248473507, 0.408498669311501, 0.360039848905913, 0.313635253114071, 0.190291685280185, 0.0966902762057164, 0.0627585210187139, 0.0169818135716442},
				                                                    {
						                                                    16.7057144613222, 14.7505192052027, 11.9016103948436, 10.618396148621,  8.05350649551352, 7.33401667486825, 6.66137658835453, 6.32620350234818, 6.31594416453469, 5.04518796305885, 4.90793311647243, 4.82913144240392, 4.64396538024632, 4.14311480208551, 3.9038143614346,  3.73898180031013, 3.63014263056341, 3.50677812073047,  3.45275009042105,  3.44979110372373, 3.15092106383462,  3.08761485066824,  3.01944628594831,  2.88916363903907,  2.8592614574653,   2.66974667592562,  2.60453978552901,  2.51438885863864,   2.49849999743817,   2.49801262739527, 2.40766875634933, 2.29028438151224, 2.15898638975217, 2.14560431334926, 2.07044215030533, 1.95418473418235, 1.88888594754324, 1.88650616172238, 1.8198721207564, 1.81193155521888, 1.75909911115049, 1.69745221456066, 1.62846548699934, 1.44782527185428, 1.4064548383697,  1.402257579811,   1.35519843738159, 1.19200677769228, 1.1758166909225,  1.1093815936921,  1.08911002693294, 1.05248084609684, 1.01504412584237, 0.964101350067133, 0.836203780534342, 0.769820542419538, 0.711014107759879, 0.704565783258251, 0.677095303890912, 0.676804631539347, 0.622458157794941, 0.605564274894241, 0.551713329151314, 0.540278693926871, 0.535068804226974, 0.534083658593357, 0.486997493094134, 0.47342904145533, 0.466691322509271, 0.466314513482617, 0.406713874644601, 0.398807667014405, 0.392418978084885, 0.35982835590929, 0.3593186813743, 0.358356148140949, 0.340050205426053, 0.33588919183582, 0.335315055145836, 0.333069641567544, 0.312911673525574, 0.293959092019542, 0.287502292456675, 0.287114929535302, 0.274679459410518, 0.270069486428297, 0.263317153901112, 0.252336888625688, 0.247082018985189, 0.223696327749984, 0.22289007378723, 0.220453700332539, 0.216455951289174, 0.204189576112103, 0.203816856242006, 0.195866800084742, 0.193318046531763, 0.19150467861053, 0.188253966476271, 0.183148949206966, 0.174148552065552, 0.171052673157679, 0.138830698342532, 0.135806003856863, 0.129894012486075, 0.129137032920589, 0.128929674102549, 0.124212659761899, 0.116332776348904, 0.110977443853375, 0.110657427410986, 0.106322915201546, 0.105996897565717, 0.10451350853217, 0.101738128945839, 0.0950860879735766, 0.0936167676896599, 0.0895459928979593, 0.0792479340809267, 0.0774187338193672, 0.0738514135266331, 0.072636059897768, 0.0723717762159917, 0.055363013399337, 0.0517497657333976, 0.0517128935875855, 0.0500167044763647, 0.0428512775058219, 0.0352569789652512, 0.0326147198007676, 0.0315605005571588, 0.0308882793101364, 0.0304228868682757, 0.0293200601494461, 0.0275195763334376, 0.0184817721306083, 0.0166723589854385, 0.0136916887517227, 0.0122945727900386, 0.0106811602779099, 0.00430952511405818, 0.00359866510988527, 0.00301215254047329, 0.00246264924247654, 0.0020866097207702, 0.00170724674071023, 0.00133918028616061, 0.00118537483156833, 0.000869421311893521, 0.000654332378541978
				                                                    }
		                                                    });

		std::vector<std::vector<sambada::reel> > popScores({
				                                                   {
						                                                   47.5508020099315, 17.8746547565823, 41.3946973283983, 13.2273316275405, 8.60027214716251, 9.38301663649486, 7.06175514048107, 6.43477864237263, 60.9753162647014, 9.46054160086123, 4.87435743023752, 4.75625060959953, 4.71230031949045, 5.07212153414218, 5.76215579054019, 3.68722867612655, 6.40749147073564, 17.6056374560984, 9.07592131335366, 5.07963522409273, 3.25709422381794, 3.07948332142468, 5.99775666160588, 2.95877114090308, 2.99620791332148, 2.65275394755201, 8.49670853015789, 12.6532301474047, 2.4741513681081,  2.43933198312777, 3.9477895884072,  2.32396232395081, 2.15181934890859, 3.92003576871639, 20.2534422625565, 1.98109361731258, 13.6480430928434, 13.5628581284628, 4.27541903406859, 1.83378256075798, 13.9187170792929, 49.0912298822102, 1.64514291648743, 2.95266037804299, 12.9170895335112, 38.20134419201,   1.34752636715621, 1.20165933576379, 7.3390942002236,  1.12942905139221, 9.62218644794984, 1.06271095654381, 1.01941693113884, 1.9037098376989,  2.10568451757081, 5.74248068468989, 1.98497615834549, 0.711602905646942, 0.673092714901941, 0.809344489206751, 0.63412820885236, 0.620483123303302, 0.552499803755609, 0.535945993511518, 0.539113178317962, 0.531951155061961, 0.486872144555491, 1.03661705899788, 4.860531961481, 11.7091360121462, 1.63428799949418, 0.910882391787368, 0.389489859715923, 0.545043464147966, 0.358667887341085, 0.358935983145898, 0.819294943689897, 0.339656013793501, 2.56260400306905, 7.7126808083907, 0.313500575440685, 0.288043096836475, 3.71285446879551, 0.29021353067651, 0.275540812126565, 0.272711125497722, 0.264448476216444, 0.252477811146036, 0.343637586605041, 2.47979971862264, 0.218630005631837, 1.05357082418845, 2.09230010354733, 2.52882922603681, 0.201418113006469, 0.195529992959223, 0.199035222293986, 0.191697489181593, 0.18852730486401, 20.1521431603426, 0.173898053882112, 0.195955008342025, 15.0508415854339, 0.136815048297876, 19.0563384681665, 0.129455107790022, 0.128899332972367, 0.123752907627022, 0.117088749391655, 0.111258455390839, 0.111476717141045, 0.105591690772712, 0.10572171082697, 2.20414882775776, 0.101777918380321, 0.0948415542342218, 0.0936061587992754, 0.0891243953428784, 0.520716267685785, 0.190741899003029, 0.366561509310657, 6.65955823929983, 16.8098670408702, 0.0554287911890015, 55.3446999942083, 0.0525618139704562, 0.0492864459106954, 0.0428688739580139, 0.517722496794931, 7.93659103398238, 11.2176856416345, 0.164087439094715, 0.030367642005217, 0.0293285980617384, 0.0274944245499, 11.3346413757181, 0.0166480415564365, 0.0136538181333208, 0.0122873798907221, 0.0106850652329058, 0.00430316354027127, 0.00359681688553337, 0.00300829998519703, 0.00245608875286507, 0.00208598889241784, 0.00170675502408812, 0.00133940809303112, 0.00118578230876665, 0.000869578624019596, 0.000654287202678461
				                                                   },
				                                                   {
						                                                   39.8279822628157, 17.5355078954831, 35.7750763561748, 13.1079784454148, 8.05350649551352, 9.02870635119507, 6.80159976120709, 6.32620350234818, 54.2708675504136, 9.05781176426883, 4.90793311647243, 4.82913144240392, 4.64396538024632, 5.00450667262304, 5.63509017629403, 3.73898180031013, 6.09315438937869, 17.8373307233592, 8.92631263729097, 5.00798584426854, 3.15092106383462, 3.08761485066824, 5.87269916338002, 2.88916363903907, 2.8592614574653,  2.66974667592562, 8.3641016468639,  12.2904428712594, 2.49849999743817, 2.49801262739527, 3.94245013347282, 2.29028438151224, 2.15898638975217, 3.76848251137127, 18.6396940589113, 1.95418473418235, 13.2711768218222, 12.7612109924091, 4.39622917270267, 1.81193155521888, 13.4948250897266, 44.5742167958631, 1.62846548699934, 2.95765038087526, 12.8723423997447, 35.0903369076723, 1.35519843738159, 1.19200677769228, 7.08779237826081, 1.1093815936921,  9.40622899216253, 1.05248084609684, 1.01504412584237, 1.83714665347872, 2.07594900763496, 5.83442557928908, 1.98613554480328, 0.704565783258251, 0.677095303890912, 0.805962100042454, 0.622458157794941, 0.618668806128414, 0.551713329151314, 0.540278693926871, 0.535068804226974, 0.534083658593357, 0.486997493094134, 1.04123302888657, 4.74244978414205, 11.232357660281, 1.63601110635403, 0.909953797510421, 0.392418978084885, 0.54097412059982, 0.3593186813743, 0.358356148140949, 0.836088455053715, 0.33588919183582, 2.53218086562595, 7.352987752017, 0.312911673525574, 0.293959092019542, 4.12103240008625, 0.287114929535302, 0.274679459410518, 0.270069486428297, 0.263317153901112, 0.252336888625688, 0.339848863234197, 2.43484655243785, 0.22289007378723, 1.05434364763425, 2.05380650005053, 2.51914909418609, 0.203816856242006, 0.195866800084742, 0.193318046531763, 0.19150467861053, 0.188253966476271, 18.7315330194447, 0.174148552065552, 0.196355865611352, 14.6118469286213, 0.135806003856863, 18.5497220515591, 0.129137032920589, 0.128929674102549, 0.124212659761899, 0.116332776348904, 0.110977443853375, 0.110657427410986, 0.106322915201546, 0.105996897565717, 2.17916290883742, 0.101738128945839, 0.0950860879735766, 0.0936167676896599, 0.0895459928979593, 0.571535083831571, 0.1937858687466, 0.362829566491438, 6.64158883120928, 16.7042290667909, 0.055363013399337, 45.2250279146836, 0.0517128935875855, 0.0500167044763647, 0.0428512775058219, 0.515251030665599, 7.42061693778372, 10.6286936547089, 0.163680646634254, 0.0304228868682757, 0.0293200601494461, 0.0275195763334376, 11.0741513614472, 0.0166723589854385, 0.0136916887517227, 0.0122945727900386, 0.0106811602779099, 0.00430952511405818, 0.00359866510988527, 0.00301215254047329, 0.00246264924247654, 0.0020866097207702, 0.00170724674071023, 0.00133918028616061, 0.00118537483156833, 0.000869421311893521, 0.000654332378541978
				                                                   }
		                                                   });

		int dimMax(3);
		sambada::StoreyHistograms storeyHistograms(dimMax);

		for (int i(1); i <= dimMax; ++i)
		{
			for (auto scoreG(GScores[i - 1].begin()); scoreG != GScores[i - 1].end(); ++scoreG)
			{
				storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::G, i, *scoreG);
			}

			for (auto scoreWald(WaldScores[i - 1].begin()); scoreWald != WaldScores[i - 1].end(); ++scoreWald)
			{
				storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::Wald, i, *scoreWald);
			}
		}

		for (auto scoreG(popScores[0].begin()); scoreG != popScores[0].end(); ++scoreG)
		{
			storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::GPop, dimMax, *scoreG);
		}

		for (auto scoreWald(popScores[1].begin()); scoreWald != popScores[1].end(); ++scoreWald)
		{
			storeyHistograms.addValue(sambada::StoreyHistograms::ScoreType::WaldPop, dimMax, *scoreWald);
		}

		std::ostringstream outputStream(std::ios_base::out);

		sambada::StoreyHistogramsStreamWriter writer;
		writer.write(storeyHistograms, outputStream, false);
		std::string output(outputStream.str());

		std::istringstream iss(output.c_str());

		SambadaStoreyHistogramMapper mapper;
		SambadaStoreyHistogram storeyHistogram(mapper.readStoreyHistogram(iss));

		storeyHistogram.verifieTailles(12);

		storeyHistogram.compare(expectedStoreyHistogram);

	}
}
